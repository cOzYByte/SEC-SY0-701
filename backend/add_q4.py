"""
CompTIA Security+ SY0-701 Questions - Batch 4
"""
import asyncio
from motor.motor_asyncio import AsyncIOMotorClient
import uuid
import os
from dotenv import load_dotenv
from pathlib import Path

ROOT_DIR = Path(__file__).parent
load_dotenv(ROOT_DIR / '.env')

mongo_url = os.environ['MONGO_URL']
client = AsyncIOMotorClient(mongo_url)
db = client[os.environ['DB_NAME']]

questions = [
    # Domain 1 - More General Security Concepts
    {"domain": 1, "domain_name": "General Security Concepts", "question": "What is the primary purpose of obfuscation?", "options": [{"id": "a", "text": "To encrypt data"}, {"id": "b", "text": "To make code or data difficult to understand"}, {"id": "c", "text": "To compress files"}, {"id": "d", "text": "To speed up processing"}], "correct_answer": "b", "explanation": "Obfuscation makes code or data difficult to understand or reverse engineer. It's not encryption but provides security through obscurity as an additional layer."},
    {"domain": 1, "domain_name": "General Security Concepts", "question": "What is a wildcard certificate?", "options": [{"id": "a", "text": "A certificate for gaming sites"}, {"id": "b", "text": "A certificate valid for all subdomains of a domain"}, {"id": "c", "text": "An expired certificate"}, {"id": "d", "text": "A self-signed certificate"}], "correct_answer": "b", "explanation": "A wildcard certificate (*.example.com) is valid for all subdomains of a domain, simplifying certificate management for organizations with many subdomains."},
    {"domain": 1, "domain_name": "General Security Concepts", "question": "What is certificate pinning?", "options": [{"id": "a", "text": "Physically securing certificates"}, {"id": "b", "text": "Associating a host with expected certificate or public key"}, {"id": "c", "text": "Attaching certificates to emails"}, {"id": "d", "text": "Storing certificates on pins"}], "correct_answer": "b", "explanation": "Certificate pinning associates a host with its expected certificate or public key, preventing man-in-the-middle attacks even if a CA is compromised."},
    {"domain": 1, "domain_name": "General Security Concepts", "question": "What is the purpose of a registration authority (RA)?", "options": [{"id": "a", "text": "To issue certificates"}, {"id": "b", "text": "To verify identity before certificate issuance"}, {"id": "c", "text": "To revoke certificates"}, {"id": "d", "text": "To store certificates"}], "correct_answer": "b", "explanation": "A Registration Authority verifies the identity of certificate requesters before the CA issues certificates. It offloads verification work from the CA."},
    {"domain": 1, "domain_name": "General Security Concepts", "question": "What is ECC (Elliptic Curve Cryptography)?", "options": [{"id": "a", "text": "Error correction code"}, {"id": "b", "text": "Asymmetric encryption using elliptic curves"}, {"id": "c", "text": "A symmetric cipher"}, {"id": "d", "text": "A hashing algorithm"}], "correct_answer": "b", "explanation": "ECC is asymmetric encryption based on elliptic curves. It provides equivalent security to RSA with smaller key sizes, making it efficient for mobile devices."},
    {"domain": 1, "domain_name": "General Security Concepts", "question": "What is a session key?", "options": [{"id": "a", "text": "A permanent encryption key"}, {"id": "b", "text": "A temporary key used for a single session"}, {"id": "c", "text": "A key for keyboard sessions"}, {"id": "d", "text": "A master key"}], "correct_answer": "b", "explanation": "A session key is a temporary symmetric key used for a single communication session. It's typically exchanged using asymmetric encryption then used for faster symmetric encryption."},
    {"domain": 1, "domain_name": "General Security Concepts", "question": "What is a hardware root of trust?", "options": [{"id": "a", "text": "The main circuit board"}, {"id": "b", "text": "Hardware that provides a secure foundation for the system"}, {"id": "c", "text": "Root user access"}, {"id": "d", "text": "Physical security locks"}], "correct_answer": "b", "explanation": "A hardware root of trust is tamper-resistant hardware (like TPM) that provides a secure foundation for system security, storing keys and verifying system integrity."},
    {"domain": 1, "domain_name": "General Security Concepts", "question": "What is the purpose of secure boot?", "options": [{"id": "a", "text": "Faster startup"}, {"id": "b", "text": "Ensuring only trusted software runs during boot"}, {"id": "c", "text": "Password protection at boot"}, {"id": "d", "text": "Network boot capability"}], "correct_answer": "b", "explanation": "Secure boot ensures only digitally signed, trusted software loads during the boot process, protecting against bootkits and rootkits."},
    {"domain": 1, "domain_name": "General Security Concepts", "question": "What is measured boot?", "options": [{"id": "a", "text": "Timing boot speed"}, {"id": "b", "text": "Recording hashes of boot components for later verification"}, {"id": "c", "text": "Measuring boot partition size"}, {"id": "d", "text": "Counting boot attempts"}], "correct_answer": "b", "explanation": "Measured boot records hashes of boot components in the TPM. These measurements can be sent to a remote server for attestation, verifying system integrity."},
    {"domain": 1, "domain_name": "General Security Concepts", "question": "What is tokenization vs encryption?", "options": [{"id": "a", "text": "They are identical"}, {"id": "b", "text": "Tokenization replaces data with tokens; encryption transforms data mathematically"}, {"id": "c", "text": "Encryption is simpler"}, {"id": "d", "text": "Tokenization is reversible without a key"}], "correct_answer": "b", "explanation": "Tokenization replaces sensitive data with non-sensitive tokens (stored separately). Encryption mathematically transforms data using keys. Tokens have no mathematical relationship to original data."},
    {"domain": 1, "domain_name": "General Security Concepts", "question": "What is homomorphic encryption?", "options": [{"id": "a", "text": "Encryption for home use"}, {"id": "b", "text": "Encryption allowing computation on encrypted data"}, {"id": "c", "text": "Same encryption on both ends"}, {"id": "d", "text": "Human-readable encryption"}], "correct_answer": "b", "explanation": "Homomorphic encryption allows computations on encrypted data without decrypting it first. Results when decrypted match operations on plaintext, enabling secure cloud computing."},
    {"domain": 1, "domain_name": "General Security Concepts", "question": "What is a TPM (Trusted Platform Module)?", "options": [{"id": "a", "text": "Total protection module"}, {"id": "b", "text": "Hardware chip for cryptographic operations and key storage"}, {"id": "c", "text": "Software security suite"}, {"id": "d", "text": "Network monitoring tool"}], "correct_answer": "b", "explanation": "A TPM is a dedicated hardware chip that performs cryptographic operations, stores encryption keys, and enables features like secure boot and disk encryption."},
    
    # Domain 2 - More Threats & Vulnerabilities
    {"domain": 2, "domain_name": "Threats, Vulnerabilities & Mitigations", "question": "What is a polymorphic virus?", "options": [{"id": "a", "text": "A virus affecting multiple platforms"}, {"id": "b", "text": "A virus that changes its code to avoid detection"}, {"id": "c", "text": "A virus with multiple payloads"}, {"id": "d", "text": "A beneficial virus"}], "correct_answer": "b", "explanation": "A polymorphic virus changes its code with each infection while maintaining its functionality, making signature-based detection difficult."},
    {"domain": 2, "domain_name": "Threats, Vulnerabilities & Mitigations", "question": "What is a metamorphic virus?", "options": [{"id": "a", "text": "A virus that transforms files"}, {"id": "b", "text": "A virus that completely rewrites itself while maintaining functionality"}, {"id": "c", "text": "A shape-shifting physical threat"}, {"id": "d", "text": "A virus affecting metadata"}], "correct_answer": "b", "explanation": "A metamorphic virus completely rewrites its code with each infection, not just encrypting or rearranging it. This makes it even harder to detect than polymorphic viruses."},
    {"domain": 2, "domain_name": "Threats, Vulnerabilities & Mitigations", "question": "What is a PUP (Potentially Unwanted Program)?", "options": [{"id": "a", "text": "A puppy screensaver"}, {"id": "b", "text": "Software that may be unwanted despite user consent"}, {"id": "c", "text": "An unpatched program"}, {"id": "d", "text": "A programming error"}], "correct_answer": "b", "explanation": "PUPs are programs that users may not want despite technically consenting to install them, often bundled with other software. They include adware, toolbars, and browser hijackers."},
    {"domain": 2, "domain_name": "Threats, Vulnerabilities & Mitigations", "question": "What is LDAP injection?", "options": [{"id": "a", "text": "Injecting LDAP servers"}, {"id": "b", "text": "Exploiting LDAP queries with malicious input"}, {"id": "c", "text": "Adding users to LDAP"}, {"id": "d", "text": "LDAP configuration"}], "correct_answer": "b", "explanation": "LDAP injection exploits applications that construct LDAP queries from user input, potentially allowing attackers to view or modify directory data."},
    {"domain": 2, "domain_name": "Threats, Vulnerabilities & Mitigations", "question": "What is XML injection?", "options": [{"id": "a", "text": "Adding XML tags"}, {"id": "b", "text": "Inserting malicious content into XML data or queries"}, {"id": "c", "text": "XML file creation"}, {"id": "d", "text": "XML validation"}], "correct_answer": "b", "explanation": "XML injection inserts malicious content into XML data or XPath/XQuery queries, potentially exposing data or causing application errors."},
    {"domain": 2, "domain_name": "Threats, Vulnerabilities & Mitigations", "question": "What is an XXE (XML External Entity) attack?", "options": [{"id": "a", "text": "Extra XML elements"}, {"id": "b", "text": "Exploiting XML parsers to access external resources"}, {"id": "c", "text": "XML encryption exploit"}, {"id": "d", "text": "XML extension error"}], "correct_answer": "b", "explanation": "XXE attacks exploit XML parsers that process external entity references, potentially allowing file access, SSRF, or denial of service."},
    {"domain": 2, "domain_name": "Threats, Vulnerabilities & Mitigations", "question": "What is SSRF (Server-Side Request Forgery)?", "options": [{"id": "a", "text": "SSL request failure"}, {"id": "b", "text": "Tricking a server into making requests to unintended locations"}, {"id": "c", "text": "Server synchronization"}, {"id": "d", "text": "Session forgery"}], "correct_answer": "b", "explanation": "SSRF tricks a server into making requests to unintended internal or external resources, potentially accessing internal services or cloud metadata."},
    {"domain": 2, "domain_name": "Threats, Vulnerabilities & Mitigations", "question": "What is clickjacking?", "options": [{"id": "a", "text": "Stealing mouse clicks"}, {"id": "b", "text": "Tricking users into clicking hidden elements"}, {"id": "c", "text": "Click counting"}, {"id": "d", "text": "Automated clicking"}], "correct_answer": "b", "explanation": "Clickjacking overlays invisible elements over legitimate content, tricking users into clicking something different than intended, like a hidden button."},
    {"domain": 2, "domain_name": "Threats, Vulnerabilities & Mitigations", "question": "What is domain hijacking?", "options": [{"id": "a", "text": "Stealing physical servers"}, {"id": "b", "text": "Unauthorized transfer of domain registration"}, {"id": "c", "text": "DNS configuration"}, {"id": "d", "text": "Domain parking"}], "correct_answer": "b", "explanation": "Domain hijacking is unauthorized transfer of domain registration, often through social engineering registrars or compromising registrant accounts."},
    {"domain": 2, "domain_name": "Threats, Vulnerabilities & Mitigations", "question": "What is BGP hijacking?", "options": [{"id": "a", "text": "Stealing network equipment"}, {"id": "b", "text": "Maliciously rerouting internet traffic via BGP announcements"}, {"id": "c", "text": "Bandwidth stealing"}, {"id": "d", "text": "Browser hijacking"}], "correct_answer": "b", "explanation": "BGP hijacking announces false BGP routes to redirect internet traffic through attacker-controlled networks, enabling interception or black-holing of traffic."},
    {"domain": 2, "domain_name": "Threats, Vulnerabilities & Mitigations", "question": "What is a Smurf attack?", "options": [{"id": "a", "text": "An attack using small packets"}, {"id": "b", "text": "ICMP flood using broadcast amplification"}, {"id": "c", "text": "Blue-themed malware"}, {"id": "d", "text": "A small-scale attack"}], "correct_answer": "b", "explanation": "A Smurf attack sends ICMP requests to broadcast addresses with a spoofed source IP. All hosts respond to the victim, amplifying the attack traffic."},
    {"domain": 2, "domain_name": "Threats, Vulnerabilities & Mitigations", "question": "What is a fraggle attack?", "options": [{"id": "a", "text": "A physical attack"}, {"id": "b", "text": "UDP-based amplification attack similar to Smurf"}, {"id": "c", "text": "Fragment-based attack"}, {"id": "d", "text": "Firewall bypass"}], "correct_answer": "b", "explanation": "A fraggle attack is similar to Smurf but uses UDP echo instead of ICMP. It sends UDP packets to broadcast addresses with spoofed source addresses."},
    {"domain": 2, "domain_name": "Threats, Vulnerabilities & Mitigations", "question": "What is a SYN flood attack?", "options": [{"id": "a", "text": "Synchronizing clocks maliciously"}, {"id": "b", "text": "Exhausting server resources with half-open TCP connections"}, {"id": "c", "text": "Synonym-based attack"}, {"id": "d", "text": "Synthetic data injection"}], "correct_answer": "b", "explanation": "A SYN flood sends many TCP SYN requests without completing the handshake, exhausting server resources with half-open connections. SYN cookies help mitigate this."},
    {"domain": 2, "domain_name": "Threats, Vulnerabilities & Mitigations", "question": "What is a teardrop attack?", "options": [{"id": "a", "text": "Social engineering using emotions"}, {"id": "b", "text": "Sending malformed fragmented packets"}, {"id": "c", "text": "Data leakage attack"}, {"id": "d", "text": "Tear gas deployment"}], "correct_answer": "b", "explanation": "A teardrop attack sends fragmented packets with overlapping offset values, causing older systems to crash when reassembling them."},
    {"domain": 2, "domain_name": "Threats, Vulnerabilities & Mitigations", "question": "What is a land attack?", "options": [{"id": "a", "text": "Physical intrusion"}, {"id": "b", "text": "TCP packet with same source and destination"}, {"id": "c", "text": "Land-based warfare"}, {"id": "d", "text": "Geographic targeting"}], "correct_answer": "b", "explanation": "A land attack sends TCP packets where source and destination IP/port are the same, causing some systems to loop or crash."},
    
    # Domain 3 - More Security Architecture
    {"domain": 3, "domain_name": "Security Architecture", "question": "What is a SWG (Secure Web Gateway)?", "options": [{"id": "a", "text": "Software gateway"}, {"id": "b", "text": "Security solution filtering web traffic"}, {"id": "c", "text": "Switch gateway"}, {"id": "d", "text": "Storage gateway"}], "correct_answer": "b", "explanation": "A Secure Web Gateway filters web traffic for malware, enforces policies, and provides URL filtering, protecting users from web-based threats."},
    {"domain": 3, "domain_name": "Security Architecture", "question": "What is DMARC?", "options": [{"id": "a", "text": "Domain monitoring and control"}, {"id": "b", "text": "Email authentication using SPF and DKIM"}, {"id": "c", "text": "DNS management"}, {"id": "d", "text": "Data marking"}], "correct_answer": "b", "explanation": "DMARC (Domain-based Message Authentication, Reporting & Conformance) uses SPF and DKIM to authenticate email senders and specify handling of failures."},
    {"domain": 3, "domain_name": "Security Architecture", "question": "What is SPF in email security?", "options": [{"id": "a", "text": "Spam protection filter"}, {"id": "b", "text": "DNS record specifying authorized mail servers"}, {"id": "c", "text": "Security policy framework"}, {"id": "d", "text": "Secure protocol format"}], "correct_answer": "b", "explanation": "SPF (Sender Policy Framework) is a DNS record that specifies which mail servers are authorized to send email for a domain, helping prevent spoofing."},
    {"domain": 3, "domain_name": "Security Architecture", "question": "What is DKIM?", "options": [{"id": "a", "text": "Domain key infrastructure"}, {"id": "b", "text": "Email authentication using digital signatures"}, {"id": "c", "text": "Data key integration"}, {"id": "d", "text": "Domain knowledge index"}], "correct_answer": "b", "explanation": "DKIM (DomainKeys Identified Mail) adds digital signatures to emails, allowing recipients to verify the message came from the claimed domain and wasn't altered."},
    {"domain": 3, "domain_name": "Security Architecture", "question": "What is the purpose of DNS over HTTPS (DoH)?", "options": [{"id": "a", "text": "Faster DNS"}, {"id": "b", "text": "Encrypting DNS queries to prevent eavesdropping"}, {"id": "c", "text": "DNS over HTTP protocol"}, {"id": "d", "text": "Domain hosting"}], "correct_answer": "b", "explanation": "DNS over HTTPS encrypts DNS queries within HTTPS, preventing eavesdropping and manipulation of DNS traffic by ISPs or attackers."},
    {"domain": 3, "domain_name": "Security Architecture", "question": "What is VLAN hopping?", "options": [{"id": "a", "text": "Moving between VLANs legitimately"}, {"id": "b", "text": "Attack technique to access other VLANs"}, {"id": "c", "text": "VLAN configuration"}, {"id": "d", "text": "Network optimization"}], "correct_answer": "b", "explanation": "VLAN hopping attacks allow access to traffic on other VLANs through switch spoofing or double tagging. Proper switch configuration prevents this."},
    {"domain": 3, "domain_name": "Security Architecture", "question": "What is MAC flooding?", "options": [{"id": "a", "text": "Too many MAC addresses"}, {"id": "b", "text": "Overflowing switch MAC tables to force broadcast mode"}, {"id": "c", "text": "Flooding with Apple devices"}, {"id": "d", "text": "MAC address conflicts"}], "correct_answer": "b", "explanation": "MAC flooding sends many packets with different MAC addresses, overflowing the switch's CAM table and forcing it to broadcast, enabling sniffing."},
    {"domain": 3, "domain_name": "Security Architecture", "question": "What is loop protection in networking?", "options": [{"id": "a", "text": "Preventing infinite loops in code"}, {"id": "b", "text": "Preventing broadcast storms from network loops"}, {"id": "c", "text": "Loop antenna protection"}, {"id": "d", "text": "Audio feedback prevention"}], "correct_answer": "b", "explanation": "Loop protection (like STP) prevents broadcast storms caused by physical network loops. Without it, broadcasts would loop infinitely, crashing the network."},
    {"domain": 3, "domain_name": "Security Architecture", "question": "What is BPDU guard?", "options": [{"id": "a", "text": "Bridge protection unit"}, {"id": "b", "text": "Disables port if it receives spanning tree BPDUs"}, {"id": "c", "text": "Backup power guard"}, {"id": "d", "text": "Bandwidth protection"}], "correct_answer": "b", "explanation": "BPDU guard disables a port if it receives Bridge Protocol Data Units, protecting against rogue switches and STP manipulation attacks."},
    {"domain": 3, "domain_name": "Security Architecture", "question": "What is DHCP snooping?", "options": [{"id": "a", "text": "Monitoring DHCP traffic"}, {"id": "b", "text": "Validating DHCP messages to prevent rogue servers"}, {"id": "c", "text": "DHCP optimization"}, {"id": "d", "text": "DHCP logging"}], "correct_answer": "b", "explanation": "DHCP snooping validates DHCP messages and builds a binding database, preventing rogue DHCP servers from assigning malicious configurations."},
    {"domain": 3, "domain_name": "Security Architecture", "question": "What is dynamic ARP inspection (DAI)?", "options": [{"id": "a", "text": "ARP caching"}, {"id": "b", "text": "Validating ARP packets against DHCP snooping database"}, {"id": "c", "text": "ARP table cleanup"}, {"id": "d", "text": "ARP timeout configuration"}], "correct_answer": "b", "explanation": "DAI validates ARP packets against the DHCP snooping binding database, preventing ARP spoofing attacks on the network."},
    {"domain": 3, "domain_name": "Security Architecture", "question": "What is IP Source Guard?", "options": [{"id": "a", "text": "Firewall feature"}, {"id": "b", "text": "Filtering traffic based on DHCP snooping bindings"}, {"id": "c", "text": "IP address reservation"}, {"id": "d", "text": "Source code protection"}], "correct_answer": "b", "explanation": "IP Source Guard filters traffic based on DHCP snooping bindings, ensuring hosts only use their assigned IP addresses, preventing IP spoofing."},
    
    # Domain 4 - More Security Operations
    {"domain": 4, "domain_name": "Security Operations", "question": "What is a security orchestration platform?", "options": [{"id": "a", "text": "Music for security teams"}, {"id": "b", "text": "Tool that coordinates security tools and automates responses"}, {"id": "c", "text": "Security team management"}, {"id": "d", "text": "Conducting security assessments"}], "correct_answer": "b", "explanation": "Security orchestration platforms (SOAR) coordinate multiple security tools, automate response actions, and streamline security operations workflows."},
    {"domain": 4, "domain_name": "Security Operations", "question": "What is the diamond model of intrusion analysis?", "options": [{"id": "a", "text": "Jewelry theft analysis"}, {"id": "b", "text": "Framework relating adversary, capability, infrastructure, and victim"}, {"id": "c", "text": "Diamond-shaped network"}, {"id": "d", "text": "Premium threat analysis"}], "correct_answer": "b", "explanation": "The diamond model relates four core features of intrusions: adversary, capability, infrastructure, and victim. It helps analysts understand and track attacks."},
    {"domain": 4, "domain_name": "Security Operations", "question": "What is a TTP in threat intelligence?", "options": [{"id": "a", "text": "Total threat protection"}, {"id": "b", "text": "Tactics, Techniques, and Procedures"}, {"id": "c", "text": "Threat tracking protocol"}, {"id": "d", "text": "Time to protect"}], "correct_answer": "b", "explanation": "TTPs describe how threat actors operate: Tactics (why), Techniques (how), and Procedures (specific implementation). Understanding TTPs helps predict and detect attacks."},
    {"domain": 4, "domain_name": "Security Operations", "question": "What is STIX in threat intelligence?", "options": [{"id": "a", "text": "Security testing index"}, {"id": "b", "text": "Structured Threat Information eXpression"}, {"id": "c", "text": "System threat identification"}, {"id": "d", "text": "Standard threat input"}], "correct_answer": "b", "explanation": "STIX is a standardized language for representing cyber threat information, enabling consistent sharing and analysis of threat data between organizations."},
    {"domain": 4, "domain_name": "Security Operations", "question": "What is TAXII?", "options": [{"id": "a", "text": "Transportation service"}, {"id": "b", "text": "Protocol for exchanging threat intelligence"}, {"id": "c", "text": "Tax information system"}, {"id": "d", "text": "Testing and examination"}], "correct_answer": "b", "explanation": "TAXII (Trusted Automated eXchange of Intelligence Information) is a protocol for exchanging STIX-formatted threat intelligence between organizations."},
    {"domain": 4, "domain_name": "Security Operations", "question": "What is a fusion center in security?", "options": [{"id": "a", "text": "Nuclear facility"}, {"id": "b", "text": "Facility combining threat intelligence from multiple sources"}, {"id": "c", "text": "Data center"}, {"id": "d", "text": "Fusion cuisine security"}], "correct_answer": "b", "explanation": "A fusion center combines threat intelligence from multiple sources (government, private sector, international) to provide comprehensive threat awareness."},
    {"domain": 4, "domain_name": "Security Operations", "question": "What is the purpose of hashing in forensics?", "options": [{"id": "a", "text": "Encrypting evidence"}, {"id": "b", "text": "Verifying evidence integrity"}, {"id": "c", "text": "Compressing files"}, {"id": "d", "text": "Cataloging evidence"}], "correct_answer": "b", "explanation": "Hashing creates a unique fingerprint of evidence. Comparing hashes verifies that evidence hasn't been modified, maintaining integrity for legal proceedings."},
    {"domain": 4, "domain_name": "Security Operations", "question": "What is live acquisition in forensics?", "options": [{"id": "a", "text": "Acquiring systems while running"}, {"id": "b", "text": "Collecting volatile data from running systems"}, {"id": "c", "text": "Live streaming acquisition"}, {"id": "d", "text": "Real-time purchasing"}], "correct_answer": "b", "explanation": "Live acquisition captures volatile data (RAM, network connections, running processes) from a running system before shutdown, preserving evidence that would be lost."},
    {"domain": 4, "domain_name": "Security Operations", "question": "What is the purpose of a jump kit?", "options": [{"id": "a", "text": "Exercise equipment"}, {"id": "b", "text": "Pre-packed tools for incident response"}, {"id": "c", "text": "Network cables"}, {"id": "d", "text": "Power backup"}], "correct_answer": "b", "explanation": "A jump kit contains pre-packed hardware, software, and documentation for incident response, allowing rapid deployment to investigate security incidents."},
    {"domain": 4, "domain_name": "Security Operations", "question": "What is memory forensics?", "options": [{"id": "a", "text": "Improving memory"}, {"id": "b", "text": "Analyzing RAM for evidence of malicious activity"}, {"id": "c", "text": "Memory optimization"}, {"id": "d", "text": "Storage forensics"}], "correct_answer": "b", "explanation": "Memory forensics analyzes RAM dumps to find malware, encryption keys, passwords, and evidence of malicious activity that exists only in volatile memory."},
    {"domain": 4, "domain_name": "Security Operations", "question": "What is network forensics?", "options": [{"id": "a", "text": "Network troubleshooting"}, {"id": "b", "text": "Capturing and analyzing network traffic for investigation"}, {"id": "c", "text": "Network optimization"}, {"id": "d", "text": "Network design"}], "correct_answer": "b", "explanation": "Network forensics captures and analyzes network traffic to investigate security incidents, identify attackers, and understand attack methods."},
    {"domain": 4, "domain_name": "Security Operations", "question": "What is e-discovery?", "options": [{"id": "a", "text": "Electronic shopping"}, {"id": "b", "text": "Identifying and collecting electronic evidence for legal proceedings"}, {"id": "c", "text": "Email discovery"}, {"id": "d", "text": "Network discovery"}], "correct_answer": "b", "explanation": "E-discovery is the process of identifying, collecting, and producing electronically stored information (ESI) for legal proceedings or investigations."},
    
    # Domain 5 - More Security Program Management
    {"domain": 5, "domain_name": "Security Program Management", "question": "What is exposure factor (EF)?", "options": [{"id": "a", "text": "Sun exposure risk"}, {"id": "b", "text": "Percentage of asset value lost in an incident"}, {"id": "c", "text": "Public exposure"}, {"id": "d", "text": "Media exposure"}], "correct_answer": "b", "explanation": "Exposure Factor is the percentage of an asset's value that would be lost if a specific threat occurs. It's used to calculate Single Loss Expectancy (SLE = AV × EF)."},
    {"domain": 5, "domain_name": "Security Program Management", "question": "What is ARO (Annual Rate of Occurrence)?", "options": [{"id": "a", "text": "Average response operation"}, {"id": "b", "text": "Expected frequency of a threat per year"}, {"id": "c", "text": "Annual report output"}, {"id": "d", "text": "Assessment review order"}], "correct_answer": "b", "explanation": "ARO estimates how often a specific threat is expected to occur per year. It's used to calculate Annual Loss Expectancy (ALE = SLE × ARO)."},
    {"domain": 5, "domain_name": "Security Program Management", "question": "What is residual risk?", "options": [{"id": "a", "text": "Leftover food risk"}, {"id": "b", "text": "Risk remaining after controls are implemented"}, {"id": "c", "text": "Historical risk"}, {"id": "d", "text": "Environmental risk"}], "correct_answer": "b", "explanation": "Residual risk is the risk that remains after security controls are implemented. The goal is to reduce residual risk to a level acceptable to the organization."},
    {"domain": 5, "domain_name": "Security Program Management", "question": "What is a risk matrix?", "options": [{"id": "a", "text": "Mathematical formula"}, {"id": "b", "text": "Tool plotting likelihood against impact to prioritize risks"}, {"id": "c", "text": "Movie about risk"}, {"id": "d", "text": "Insurance table"}], "correct_answer": "b", "explanation": "A risk matrix plots likelihood against impact to visualize and prioritize risks. It helps organizations focus resources on the highest-priority risks."},
    {"domain": 5, "domain_name": "Security Program Management", "question": "What is control effectiveness?", "options": [{"id": "a", "text": "How well controls are designed"}, {"id": "b", "text": "How well controls reduce risk"}, {"id": "c", "text": "Control room efficiency"}, {"id": "d", "text": "Remote control range"}], "correct_answer": "b", "explanation": "Control effectiveness measures how well a security control reduces risk. Regular testing and assessment ensure controls continue to perform as intended."},
    {"domain": 5, "domain_name": "Security Program Management", "question": "What is a compensating control?", "options": [{"id": "a", "text": "A control that pays money"}, {"id": "b", "text": "Alternative control when primary control isn't feasible"}, {"id": "c", "text": "Backup control panel"}, {"id": "d", "text": "Employee compensation"}], "correct_answer": "b", "explanation": "A compensating control is an alternative measure used when the primary recommended control isn't feasible. It must provide equivalent protection."},
    {"domain": 5, "domain_name": "Security Program Management", "question": "What is a corrective control?", "options": [{"id": "a", "text": "Control that fixes mistakes"}, {"id": "b", "text": "Control that restores systems after an incident"}, {"id": "c", "text": "Spelling correction"}, {"id": "d", "text": "Behavioral correction"}], "correct_answer": "b", "explanation": "Corrective controls restore systems to normal after a security incident. Examples include backups, patches, and incident response procedures."},
    {"domain": 5, "domain_name": "Security Program Management", "question": "What is a directive control?", "options": [{"id": "a", "text": "Control from directors"}, {"id": "b", "text": "Control that directs behavior through policies"}, {"id": "c", "text": "Directional antenna"}, {"id": "d", "text": "Movie direction"}], "correct_answer": "b", "explanation": "Directive controls direct, confine, or control actions through policies, procedures, and guidelines. They tell people what they should or shouldn't do."},
    {"domain": 5, "domain_name": "Security Program Management", "question": "What is a deterrent control?", "options": [{"id": "a", "text": "Cleaning control"}, {"id": "b", "text": "Control that discourages security violations"}, {"id": "c", "text": "Detergent control"}, {"id": "d", "text": "Traffic control"}], "correct_answer": "b", "explanation": "Deterrent controls discourage security violations without directly preventing them. Examples include warning signs, security cameras, and login banners."},
    {"domain": 5, "domain_name": "Security Program Management", "question": "What is a preventive control?", "options": [{"id": "a", "text": "Health prevention"}, {"id": "b", "text": "Control that stops incidents from occurring"}, {"id": "c", "text": "Predictive control"}, {"id": "d", "text": "Preemptive strike"}], "correct_answer": "b", "explanation": "Preventive controls stop security incidents before they occur. Examples include firewalls, access controls, encryption, and security guards."},
    {"domain": 5, "domain_name": "Security Program Management", "question": "What is a detective control?", "options": [{"id": "a", "text": "Control by detectives"}, {"id": "b", "text": "Control that identifies security incidents"}, {"id": "c", "text": "Mystery control"}, {"id": "d", "text": "Investigation control"}], "correct_answer": "b", "explanation": "Detective controls identify security incidents during or after they occur. Examples include IDS, audit logs, security cameras, and motion sensors."},
    {"domain": 5, "domain_name": "Security Program Management", "question": "What is CIS Controls?", "options": [{"id": "a", "text": "Computer information system"}, {"id": "b", "text": "Prioritized set of security best practices"}, {"id": "c", "text": "Central intelligence system"}, {"id": "d", "text": "Customer information service"}], "correct_answer": "b", "explanation": "CIS Controls (formerly SANS Top 20) are a prioritized set of security best practices developed by the Center for Internet Security to help organizations improve their security posture."}
]

async def add_questions():
    for q in questions:
        q["id"] = str(uuid.uuid4())
    result = await db.questions.insert_many(questions)
    print(f"Added {len(result.inserted_ids)} questions")
    total = await db.questions.count_documents({})
    print(f"Total: {total}")

if __name__ == "__main__":
    asyncio.run(add_questions())
