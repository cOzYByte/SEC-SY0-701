"""
CompTIA Security+ SY0-701 Questions - Batch 5
"""
import asyncio
from motor.motor_asyncio import AsyncIOMotorClient
import uuid
import os
from dotenv import load_dotenv
from pathlib import Path

ROOT_DIR = Path(__file__).parent
load_dotenv(ROOT_DIR / '.env')

mongo_url = os.environ['MONGO_URL']
client = AsyncIOMotorClient(mongo_url)
db = client[os.environ['DB_NAME']]

questions = [
    # Domain 1 - Cryptography & PKI
    {"domain": 1, "domain_name": "General Security Concepts", "question": "What is RSA primarily used for?", "options": [{"id": "a", "text": "Hashing"}, {"id": "b", "text": "Asymmetric encryption and digital signatures"}, {"id": "c", "text": "Symmetric encryption"}, {"id": "d", "text": "Data compression"}], "correct_answer": "b", "explanation": "RSA is an asymmetric encryption algorithm used for encryption, digital signatures, and key exchange. It's based on the difficulty of factoring large prime numbers."},
    {"domain": 1, "domain_name": "General Security Concepts", "question": "What key length is recommended for RSA?", "options": [{"id": "a", "text": "512 bits"}, {"id": "b", "text": "1024 bits"}, {"id": "c", "text": "2048 bits or higher"}, {"id": "d", "text": "128 bits"}], "correct_answer": "c", "explanation": "RSA keys of 2048 bits or higher are recommended. 512 and 1024-bit keys are considered insecure due to advances in computing power."},
    {"domain": 1, "domain_name": "General Security Concepts", "question": "What is a self-signed certificate?", "options": [{"id": "a", "text": "A certificate signed by a CA"}, {"id": "b", "text": "A certificate signed by its own private key"}, {"id": "c", "text": "An expired certificate"}, {"id": "d", "text": "A revoked certificate"}], "correct_answer": "b", "explanation": "A self-signed certificate is signed by its own private key rather than a trusted CA. They're useful for testing but shouldn't be trusted for production."},
    {"domain": 1, "domain_name": "General Security Concepts", "question": "What is certificate chaining?", "options": [{"id": "a", "text": "Linking multiple certificates"}, {"id": "b", "text": "Trust path from end certificate to root CA"}, {"id": "c", "text": "Certificate backup"}, {"id": "d", "text": "Certificate renewal"}], "correct_answer": "b", "explanation": "Certificate chaining is the trust path from an end-entity certificate through intermediate CAs to a trusted root CA. Each certificate is signed by the next in the chain."},
    {"domain": 1, "domain_name": "General Security Concepts", "question": "What is a code signing certificate used for?", "options": [{"id": "a", "text": "Encrypting code"}, {"id": "b", "text": "Verifying software publisher and integrity"}, {"id": "c", "text": "Compiling code"}, {"id": "d", "text": "Debugging code"}], "correct_answer": "b", "explanation": "Code signing certificates verify that software comes from a legitimate publisher and hasn't been tampered with, providing assurance to users."},
    {"domain": 1, "domain_name": "General Security Concepts", "question": "What is an intermediate CA?", "options": [{"id": "a", "text": "A temporary CA"}, {"id": "b", "text": "A CA between root and end certificates"}, {"id": "c", "text": "A backup CA"}, {"id": "d", "text": "An expired CA"}], "correct_answer": "b", "explanation": "An intermediate CA sits between the root CA and end-entity certificates. It issues certificates while the root CA remains offline for security."},
    {"domain": 1, "domain_name": "General Security Concepts", "question": "What is key recovery?", "options": [{"id": "a", "text": "Finding lost keys"}, {"id": "b", "text": "Process to retrieve lost encryption keys"}, {"id": "c", "text": "Key generation"}, {"id": "d", "text": "Key rotation"}], "correct_answer": "b", "explanation": "Key recovery is the process to retrieve encryption keys when they're lost, often using key escrow or backup mechanisms."},
    {"domain": 1, "domain_name": "General Security Concepts", "question": "What does PGP stand for?", "options": [{"id": "a", "text": "Private Gateway Protocol"}, {"id": "b", "text": "Pretty Good Privacy"}, {"id": "c", "text": "Personal Guard Protection"}, {"id": "d", "text": "Public Group Policy"}], "correct_answer": "b", "explanation": "PGP (Pretty Good Privacy) provides cryptographic privacy and authentication for data communication, commonly used for email encryption."},
    {"domain": 1, "domain_name": "General Security Concepts", "question": "What is the web of trust?", "options": [{"id": "a", "text": "A spider web"}, {"id": "b", "text": "Decentralized trust model where users validate each other"}, {"id": "c", "text": "Internet security"}, {"id": "d", "text": "Web browser security"}], "correct_answer": "b", "explanation": "Web of trust is a decentralized trust model (used by PGP) where users validate each other's public keys, rather than relying on centralized CAs."},
    {"domain": 1, "domain_name": "General Security Concepts", "question": "What is a SAN (Subject Alternative Name) in certificates?", "options": [{"id": "a", "text": "Storage area network"}, {"id": "b", "text": "Additional identities in a single certificate"}, {"id": "c", "text": "Security area name"}, {"id": "d", "text": "System access name"}], "correct_answer": "b", "explanation": "SAN allows a certificate to include multiple identities (domain names, IPs, emails), enabling one certificate to secure multiple domains."},
    
    # Domain 2 - More Attack Types
    {"domain": 2, "domain_name": "Threats, Vulnerabilities & Mitigations", "question": "What is a Christmas tree attack?", "options": [{"id": "a", "text": "Holiday-themed malware"}, {"id": "b", "text": "TCP scan with all flags set"}, {"id": "c", "text": "Festive phishing"}, {"id": "d", "text": "December vulnerability"}], "correct_answer": "b", "explanation": "A Christmas tree attack sends TCP packets with all flags set (lit up like a Christmas tree). It's used for reconnaissance to identify operating systems."},
    {"domain": 2, "domain_name": "Threats, Vulnerabilities & Mitigations", "question": "What is banner grabbing?", "options": [{"id": "a", "text": "Stealing banners"}, {"id": "b", "text": "Collecting service information from network responses"}, {"id": "c", "text": "Creating banners"}, {"id": "d", "text": "Banner advertising"}], "correct_answer": "b", "explanation": "Banner grabbing collects information about services from their welcome messages or headers, revealing software versions for vulnerability identification."},
    {"domain": 2, "domain_name": "Threats, Vulnerabilities & Mitigations", "question": "What is OS fingerprinting?", "options": [{"id": "a", "text": "Identifying users by fingerprints"}, {"id": "b", "text": "Identifying operating systems through network behavior"}, {"id": "c", "text": "Operating system forensics"}, {"id": "d", "text": "Biometric authentication"}], "correct_answer": "b", "explanation": "OS fingerprinting identifies operating systems by analyzing network responses (TCP/IP stack behavior). Active fingerprinting sends probes; passive analyzes existing traffic."},
    {"domain": 2, "domain_name": "Threats, Vulnerabilities & Mitigations", "question": "What is a null session attack?", "options": [{"id": "a", "text": "Empty network session"}, {"id": "b", "text": "Anonymous connection to Windows shares"}, {"id": "c", "text": "Null pointer attack"}, {"id": "d", "text": "Session termination"}], "correct_answer": "b", "explanation": "A null session is an anonymous connection to Windows IPC$ share, potentially exposing user lists, shares, and other information."},
    {"domain": 2, "domain_name": "Threats, Vulnerabilities & Mitigations", "question": "What is a Kerberoasting attack?", "options": [{"id": "a", "text": "Burning Kerberos servers"}, {"id": "b", "text": "Extracting service account password hashes from Kerberos"}, {"id": "c", "text": "Kerberos configuration"}, {"id": "d", "text": "Authentication attack"}], "correct_answer": "b", "explanation": "Kerberoasting extracts service account password hashes from Kerberos ticket responses, then cracks them offline to obtain service account credentials."},
    {"domain": 2, "domain_name": "Threats, Vulnerabilities & Mitigations", "question": "What is Golden Ticket attack?", "options": [{"id": "a", "text": "Lottery scam"}, {"id": "b", "text": "Forging Kerberos TGTs using compromised KRBTGT hash"}, {"id": "c", "text": "Ticket scalping"}, {"id": "d", "text": "Movie ticket fraud"}], "correct_answer": "b", "explanation": "Golden Ticket attack forges Kerberos Ticket Granting Tickets using a compromised KRBTGT account hash, enabling unlimited domain access."},
    {"domain": 2, "domain_name": "Threats, Vulnerabilities & Mitigations", "question": "What is Silver Ticket attack?", "options": [{"id": "a", "text": "Second-place attack"}, {"id": "b", "text": "Forging Kerberos service tickets"}, {"id": "c", "text": "Jewelry theft"}, {"id": "d", "text": "Minor attack"}], "correct_answer": "b", "explanation": "Silver Ticket attack forges Kerberos service tickets using a compromised service account hash, gaining access to that specific service."},
    {"domain": 2, "domain_name": "Threats, Vulnerabilities & Mitigations", "question": "What is DCSync attack?", "options": [{"id": "a", "text": "Data center sync"}, {"id": "b", "text": "Mimicking domain controller to request password hashes"}, {"id": "c", "text": "Document sync"}, {"id": "d", "text": "Desktop sync"}], "correct_answer": "b", "explanation": "DCSync attack impersonates a domain controller to request password data replication, obtaining hashes without directly accessing the DC."},
    {"domain": 2, "domain_name": "Threats, Vulnerabilities & Mitigations", "question": "What is DCShadow attack?", "options": [{"id": "a", "text": "Shadow IT"}, {"id": "b", "text": "Registering rogue domain controller to push malicious changes"}, {"id": "c", "text": "Shadow copies"}, {"id": "d", "text": "Dark web attack"}], "correct_answer": "b", "explanation": "DCShadow registers a rogue domain controller to push malicious Active Directory changes that replicate to legitimate DCs."},
    {"domain": 2, "domain_name": "Threats, Vulnerabilities & Mitigations", "question": "What is LLMNR poisoning?", "options": [{"id": "a", "text": "Food poisoning"}, {"id": "b", "text": "Responding to LLMNR queries to capture credentials"}, {"id": "c", "text": "Link layer attack"}, {"id": "d", "text": "Protocol update"}], "correct_answer": "b", "explanation": "LLMNR poisoning responds to broadcast name resolution queries with attacker IP, capturing credentials when victims connect."},
    {"domain": 2, "domain_name": "Threats, Vulnerabilities & Mitigations", "question": "What is SMB relay attack?", "options": [{"id": "a", "text": "Server message blocking"}, {"id": "b", "text": "Relaying captured SMB authentication to other systems"}, {"id": "c", "text": "Small business attack"}, {"id": "d", "text": "Message forwarding"}], "correct_answer": "b", "explanation": "SMB relay captures SMB authentication and relays it to another system, potentially gaining unauthorized access without cracking passwords."},
    {"domain": 2, "domain_name": "Threats, Vulnerabilities & Mitigations", "question": "What is a resource exhaustion attack?", "options": [{"id": "a", "text": "Tired resources"}, {"id": "b", "text": "Depleting system resources to cause denial of service"}, {"id": "c", "text": "Resource management"}, {"id": "d", "text": "Energy attack"}], "correct_answer": "b", "explanation": "Resource exhaustion attacks consume system resources (CPU, memory, disk, connections) until the system can't serve legitimate requests."},
    
    # Domain 3 - More Architecture
    {"domain": 3, "domain_name": "Security Architecture", "question": "What is an inline security device?", "options": [{"id": "a", "text": "Device in line at a store"}, {"id": "b", "text": "Device positioned in traffic flow that can block traffic"}, {"id": "c", "text": "Backup device"}, {"id": "d", "text": "Testing device"}], "correct_answer": "b", "explanation": "An inline device sits in the network traffic path and can actively block malicious traffic. Examples include IPS and firewalls."},
    {"domain": 3, "domain_name": "Security Architecture", "question": "What is a passive security device?", "options": [{"id": "a", "text": "Inactive device"}, {"id": "b", "text": "Device that monitors traffic without blocking"}, {"id": "c", "text": "Sleeping device"}, {"id": "d", "text": "Powered-off device"}], "correct_answer": "b", "explanation": "A passive device monitors network traffic through a tap or span port without actively blocking. Examples include IDS and network monitors."},
    {"domain": 3, "domain_name": "Security Architecture", "question": "What is network TAP vs SPAN port?", "options": [{"id": "a", "text": "They're identical"}, {"id": "b", "text": "TAP copies all traffic; SPAN can miss traffic under load"}, {"id": "c", "text": "SPAN is more reliable"}, {"id": "d", "text": "TAP is software; SPAN is hardware"}], "correct_answer": "b", "explanation": "A TAP is dedicated hardware that copies all traffic. SPAN (port mirroring) can drop packets under heavy load and may miss traffic."},
    {"domain": 3, "domain_name": "Security Architecture", "question": "What is east-west traffic?", "options": [{"id": "a", "text": "Geographic routing"}, {"id": "b", "text": "Traffic between internal systems"}, {"id": "c", "text": "Internet traffic"}, {"id": "d", "text": "VPN traffic"}], "correct_answer": "b", "explanation": "East-west traffic flows between systems within the data center. North-south traffic flows between internal networks and external networks."},
    {"domain": 3, "domain_name": "Security Architecture", "question": "What is a service mesh?", "options": [{"id": "a", "text": "Mesh WiFi"}, {"id": "b", "text": "Infrastructure layer for service-to-service communication"}, {"id": "c", "text": "Service catalog"}, {"id": "d", "text": "Support desk"}], "correct_answer": "b", "explanation": "A service mesh is infrastructure that manages service-to-service communication in microservices, providing security, observability, and traffic management."},
    {"domain": 3, "domain_name": "Security Architecture", "question": "What is a sidecar proxy?", "options": [{"id": "a", "text": "Motorcycle attachment"}, {"id": "b", "text": "Proxy deployed alongside each service instance"}, {"id": "c", "text": "Backup proxy"}, {"id": "d", "text": "Side project"}], "correct_answer": "b", "explanation": "A sidecar proxy runs alongside each microservice, handling network communication, security, and observability without modifying the application."},
    {"domain": 3, "domain_name": "Security Architecture", "question": "What is infrastructure as code (IaC) security?", "options": [{"id": "a", "text": "Building security"}, {"id": "b", "text": "Security scanning of infrastructure definitions"}, {"id": "c", "text": "Code review"}, {"id": "d", "text": "Infrastructure installation"}], "correct_answer": "b", "explanation": "IaC security involves scanning infrastructure definitions (Terraform, CloudFormation) for misconfigurations and compliance issues before deployment."},
    {"domain": 3, "domain_name": "Security Architecture", "question": "What is secrets management?", "options": [{"id": "a", "text": "Keeping secrets"}, {"id": "b", "text": "Secure storage and access control for sensitive data"}, {"id": "c", "text": "Secret agent tools"}, {"id": "d", "text": "Privacy settings"}], "correct_answer": "b", "explanation": "Secrets management securely stores and controls access to sensitive data like API keys, passwords, and certificates. Tools include HashiCorp Vault."},
    {"domain": 3, "domain_name": "Security Architecture", "question": "What is a WAF rule?", "options": [{"id": "a", "text": "Dog barking rule"}, {"id": "b", "text": "Pattern that identifies and blocks malicious web traffic"}, {"id": "c", "text": "Wireless rule"}, {"id": "d", "text": "Work authorization form"}], "correct_answer": "b", "explanation": "WAF rules define patterns to identify and block malicious web traffic like SQL injection, XSS, and other application-layer attacks."},
    {"domain": 3, "domain_name": "Security Architecture", "question": "What is API gateway security?", "options": [{"id": "a", "text": "Physical gate"}, {"id": "b", "text": "Centralized API authentication, authorization, and rate limiting"}, {"id": "c", "text": "Gateway drugs"}, {"id": "d", "text": "Network gateway"}], "correct_answer": "b", "explanation": "API gateway security provides centralized authentication, authorization, rate limiting, and threat protection for APIs."},
    {"domain": 3, "domain_name": "Security Architecture", "question": "What is certificate transparency?", "options": [{"id": "a", "text": "Clear certificates"}, {"id": "b", "text": "Public logging of issued certificates"}, {"id": "c", "text": "Certificate display"}, {"id": "d", "text": "Transparent encryption"}], "correct_answer": "b", "explanation": "Certificate transparency requires public logging of issued certificates, allowing domain owners to detect unauthorized certificates issued for their domains."},
    {"domain": 3, "domain_name": "Security Architecture", "question": "What is runtime application self-protection (RASP)?", "options": [{"id": "a", "text": "Running protection"}, {"id": "b", "text": "Security built into applications that protects at runtime"}, {"id": "c", "text": "Raspberry Pi security"}, {"id": "d", "text": "Rest API security"}], "correct_answer": "b", "explanation": "RASP is security integrated into an application that can detect and prevent attacks in real-time by monitoring application behavior."},
    
    # Domain 4 - More Operations
    {"domain": 4, "domain_name": "Security Operations", "question": "What is a SIEM correlation rule?", "options": [{"id": "a", "text": "Database relationship"}, {"id": "b", "text": "Logic that identifies related security events"}, {"id": "c", "text": "Color coding rule"}, {"id": "d", "text": "Filing rule"}], "correct_answer": "b", "explanation": "SIEM correlation rules identify relationships between security events to detect attack patterns that individual events wouldn't reveal."},
    {"domain": 4, "domain_name": "Security Operations", "question": "What is user behavior analytics (UBA)?", "options": [{"id": "a", "text": "User surveys"}, {"id": "b", "text": "Analyzing user activity to detect anomalies"}, {"id": "c", "text": "Behavior modification"}, {"id": "d", "text": "Usage statistics"}], "correct_answer": "b", "explanation": "UBA uses machine learning to establish baselines of normal user behavior and detect anomalies that might indicate insider threats or compromised accounts."},
    {"domain": 4, "domain_name": "Security Operations", "question": "What is UEBA vs UBA?", "options": [{"id": "a", "text": "They're the same"}, {"id": "b", "text": "UEBA includes entity (device/application) behavior, not just users"}, {"id": "c", "text": "UEBA is older"}, {"id": "d", "text": "UBA includes more"}], "correct_answer": "b", "explanation": "UEBA (User and Entity Behavior Analytics) extends UBA to include behavior analysis of entities like devices, applications, and servers, not just users."},
    {"domain": 4, "domain_name": "Security Operations", "question": "What is deception technology?", "options": [{"id": "a", "text": "Magic tricks"}, {"id": "b", "text": "Deploying decoys to detect and mislead attackers"}, {"id": "c", "text": "Fake news detection"}, {"id": "d", "text": "Social engineering"}], "correct_answer": "b", "explanation": "Deception technology deploys decoys (honeypots, honeytokens) throughout the network to detect attackers and mislead them away from real assets."},
    {"domain": 4, "domain_name": "Security Operations", "question": "What is a honeytoken?", "options": [{"id": "a", "text": "Sweet cryptocurrency"}, {"id": "b", "text": "Fake credential or data that alerts when accessed"}, {"id": "c", "text": "Authentication token"}, {"id": "d", "text": "Reward token"}], "correct_answer": "b", "explanation": "A honeytoken is fake data (credentials, documents, database records) that triggers an alert when accessed, indicating unauthorized access."},
    {"domain": 4, "domain_name": "Security Operations", "question": "What is canary deployment?", "options": [{"id": "a", "text": "Yellow deployment"}, {"id": "b", "text": "Gradual rollout to detect issues before full deployment"}, {"id": "c", "text": "Bird watching software"}, {"id": "d", "text": "Mining deployment"}], "correct_answer": "b", "explanation": "Canary deployment gradually rolls out changes to a small subset of users first, allowing detection of issues before full deployment."},
    {"domain": 4, "domain_name": "Security Operations", "question": "What is blue team vs red team?", "options": [{"id": "a", "text": "Sports teams"}, {"id": "b", "text": "Blue defends; red attacks to test security"}, {"id": "c", "text": "Political teams"}, {"id": "d", "text": "Color preferences"}], "correct_answer": "b", "explanation": "Blue team defends the organization's security. Red team simulates attacks to test defenses. Purple team combines both for collaboration."},
    {"domain": 4, "domain_name": "Security Operations", "question": "What is purple team?", "options": [{"id": "a", "text": "Mix of colors"}, {"id": "b", "text": "Collaboration between red and blue teams"}, {"id": "c", "text": "Third party team"}, {"id": "d", "text": "Management team"}], "correct_answer": "b", "explanation": "Purple team facilitates collaboration between red (attack) and blue (defense) teams to improve overall security through shared learning."},
    {"domain": 4, "domain_name": "Security Operations", "question": "What is a bug bounty program?", "options": [{"id": "a", "text": "Pest control"}, {"id": "b", "text": "Paying researchers for finding vulnerabilities"}, {"id": "c", "text": "Software debugging"}, {"id": "d", "text": "Insect collection"}], "correct_answer": "b", "explanation": "Bug bounty programs pay security researchers for responsibly reporting vulnerabilities, crowdsourcing security testing."},
    {"domain": 4, "domain_name": "Security Operations", "question": "What is responsible disclosure?", "options": [{"id": "a", "text": "Ethical behavior"}, {"id": "b", "text": "Reporting vulnerabilities to vendors before public disclosure"}, {"id": "c", "text": "Press releases"}, {"id": "d", "text": "HR policies"}], "correct_answer": "b", "explanation": "Responsible disclosure involves reporting vulnerabilities to vendors and giving them time to patch before publicly disclosing the issue."},
    {"domain": 4, "domain_name": "Security Operations", "question": "What is full disclosure?", "options": [{"id": "a", "text": "Complete honesty"}, {"id": "b", "text": "Publicly releasing vulnerability details immediately"}, {"id": "c", "text": "Financial reporting"}, {"id": "d", "text": "Background checks"}], "correct_answer": "b", "explanation": "Full disclosure immediately releases vulnerability details publicly, pressuring vendors to patch quickly but potentially enabling attacks."},
    {"domain": 4, "domain_name": "Security Operations", "question": "What is CVE?", "options": [{"id": "a", "text": "Computer virus entity"}, {"id": "b", "text": "Common Vulnerabilities and Exposures"}, {"id": "c", "text": "Central verification entity"}, {"id": "d", "text": "Cyber vulnerability expert"}], "correct_answer": "b", "explanation": "CVE (Common Vulnerabilities and Exposures) is a database providing unique identifiers for publicly known security vulnerabilities."},
    
    # Domain 5 - More Management
    {"domain": 5, "domain_name": "Security Program Management", "question": "What is a data controller under GDPR?", "options": [{"id": "a", "text": "Database administrator"}, {"id": "b", "text": "Entity that determines purposes and means of processing"}, {"id": "c", "text": "Data entry person"}, {"id": "d", "text": "System controller"}], "correct_answer": "b", "explanation": "A data controller determines the purposes and means of processing personal data. They're responsible for GDPR compliance."},
    {"domain": 5, "domain_name": "Security Program Management", "question": "What is the right to be forgotten?", "options": [{"id": "a", "text": "Memory loss"}, {"id": "b", "text": "Right to have personal data erased"}, {"id": "c", "text": "Forgetting passwords"}, {"id": "d", "text": "Anonymous browsing"}], "correct_answer": "b", "explanation": "The right to be forgotten (right to erasure) under GDPR allows individuals to request deletion of their personal data under certain circumstances."},
    {"domain": 5, "domain_name": "Security Program Management", "question": "What is data portability?", "options": [{"id": "a", "text": "Portable storage"}, {"id": "b", "text": "Right to receive and transfer personal data"}, {"id": "c", "text": "Mobile data"}, {"id": "d", "text": "Data movement"}], "correct_answer": "b", "explanation": "Data portability is the right to receive personal data in a structured, machine-readable format and transfer it to another controller."},
    {"domain": 5, "domain_name": "Security Program Management", "question": "What is a DPO (Data Protection Officer)?", "options": [{"id": "a", "text": "Data processing operator"}, {"id": "b", "text": "Role responsible for data protection compliance"}, {"id": "c", "text": "Digital product owner"}, {"id": "d", "text": "Department head"}], "correct_answer": "b", "explanation": "A DPO is responsible for overseeing data protection strategy and compliance. GDPR requires certain organizations to appoint a DPO."},
    {"domain": 5, "domain_name": "Security Program Management", "question": "What is a privacy notice vs privacy policy?", "options": [{"id": "a", "text": "They're identical"}, {"id": "b", "text": "Notice is external communication; policy is internal rules"}, {"id": "c", "text": "Policy is external; notice is internal"}, {"id": "d", "text": "One is legal; one isn't"}], "correct_answer": "b", "explanation": "A privacy notice is external communication to individuals about data practices. A privacy policy is internal documentation governing data handling."},
    {"domain": 5, "domain_name": "Security Program Management", "question": "What is CCPA?", "options": [{"id": "a", "text": "Central computer protection act"}, {"id": "b", "text": "California Consumer Privacy Act"}, {"id": "c", "text": "Credit card processing act"}, {"id": "d", "text": "Cyber crime prevention act"}], "correct_answer": "b", "explanation": "CCPA (California Consumer Privacy Act) gives California residents rights regarding their personal information held by businesses."},
    {"domain": 5, "domain_name": "Security Program Management", "question": "What is a data subject?", "options": [{"id": "a", "text": "Email subject line"}, {"id": "b", "text": "Individual whose personal data is being processed"}, {"id": "c", "text": "Data topic"}, {"id": "d", "text": "Database subject"}], "correct_answer": "b", "explanation": "A data subject is an identified or identifiable individual whose personal data is being processed by a controller or processor."},
    {"domain": 5, "domain_name": "Security Program Management", "question": "What is consent under GDPR?", "options": [{"id": "a", "text": "Permission for anything"}, {"id": "b", "text": "Freely given, specific, informed, unambiguous agreement"}, {"id": "c", "text": "Written signature"}, {"id": "d", "text": "Verbal agreement"}], "correct_answer": "b", "explanation": "GDPR consent must be freely given, specific, informed, and unambiguous. Pre-ticked boxes or inactivity don't constitute valid consent."},
    {"domain": 5, "domain_name": "Security Program Management", "question": "What is legitimate interest under GDPR?", "options": [{"id": "a", "text": "Interesting data"}, {"id": "b", "text": "Legal basis for processing without consent when balanced against rights"}, {"id": "c", "text": "Financial interest"}, {"id": "d", "text": "Personal interest"}], "correct_answer": "b", "explanation": "Legitimate interest is a legal basis for processing personal data without consent when the controller's interests don't override the data subject's rights."},
    {"domain": 5, "domain_name": "Security Program Management", "question": "What is a breach notification requirement?", "options": [{"id": "a", "text": "Notifying about system downtime"}, {"id": "b", "text": "Legal requirement to report data breaches"}, {"id": "c", "text": "Update notifications"}, {"id": "d", "text": "Security alerts"}], "correct_answer": "b", "explanation": "Breach notification requires organizations to report data breaches to regulators (within 72 hours under GDPR) and affected individuals when required."},
    {"domain": 5, "domain_name": "Security Program Management", "question": "What is FERPA?", "options": [{"id": "a", "text": "Federal emergency response"}, {"id": "b", "text": "Federal Educational Rights and Privacy Act"}, {"id": "c", "text": "Financial regulations"}, {"id": "d", "text": "Federal encryption"}], "correct_answer": "b", "explanation": "FERPA protects the privacy of student education records, giving parents and eligible students rights regarding access and disclosure."},
    {"domain": 5, "domain_name": "Security Program Management", "question": "What is COPPA?", "options": [{"id": "a", "text": "Computer protection act"}, {"id": "b", "text": "Children's Online Privacy Protection Act"}, {"id": "c", "text": "Corporate privacy act"}, {"id": "d", "text": "Cyber operations act"}], "correct_answer": "b", "explanation": "COPPA protects children's privacy online, requiring verifiable parental consent before collecting personal information from children under 13."}
]

async def add_questions():
    for q in questions:
        q["id"] = str(uuid.uuid4())
    result = await db.questions.insert_many(questions)
    print(f"Added {len(result.inserted_ids)} questions")
    total = await db.questions.count_documents({})
    print(f"Total: {total}")

if __name__ == "__main__":
    asyncio.run(add_questions())
