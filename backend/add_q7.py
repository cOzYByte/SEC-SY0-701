"""
CompTIA Security+ SY0-701 Questions - Batch 7
"""
import asyncio
from motor.motor_asyncio import AsyncIOMotorClient
import uuid
import os
from dotenv import load_dotenv
from pathlib import Path

ROOT_DIR = Path(__file__).parent
load_dotenv(ROOT_DIR / '.env')

mongo_url = os.environ['MONGO_URL']
client = AsyncIOMotorClient(mongo_url)
db = client[os.environ['DB_NAME']]

questions = [
    # More Domain 1 - Authentication & Identity
    {"domain": 1, "domain_name": "General Security Concepts", "question": "What is SAML?", "options": [{"id": "a", "text": "Security assertion markup"}, {"id": "b", "text": "Security Assertion Markup Language for SSO"}, {"id": "c", "text": "Secure access management"}, {"id": "d", "text": "System administration markup"}], "correct_answer": "b", "explanation": "SAML is an XML-based standard for exchanging authentication and authorization data between identity providers and service providers, enabling SSO."},
    {"domain": 1, "domain_name": "General Security Concepts", "question": "What is OAuth 2.0?", "options": [{"id": "a", "text": "Authentication protocol"}, {"id": "b", "text": "Authorization framework for delegated access"}, {"id": "c", "text": "Encryption standard"}, {"id": "d", "text": "Open authentication"}], "correct_answer": "b", "explanation": "OAuth 2.0 is an authorization framework that enables applications to obtain limited access to user accounts without exposing passwords."},
    {"domain": 1, "domain_name": "General Security Concepts", "question": "What is OpenID Connect?", "options": [{"id": "a", "text": "Open network"}, {"id": "b", "text": "Identity layer built on OAuth 2.0"}, {"id": "c", "text": "Connection protocol"}, {"id": "d", "text": "Open connection"}], "correct_answer": "b", "explanation": "OpenID Connect is an identity layer on top of OAuth 2.0 that allows clients to verify identity and obtain basic profile information."},
    {"domain": 1, "domain_name": "General Security Concepts", "question": "What is Kerberos?", "options": [{"id": "a", "text": "Greek mythology"}, {"id": "b", "text": "Network authentication protocol using tickets"}, {"id": "c", "text": "Dog breed"}, {"id": "d", "text": "Encryption algorithm"}], "correct_answer": "b", "explanation": "Kerberos is a network authentication protocol using tickets to prove identity, avoiding transmitting passwords over the network."},
    {"domain": 1, "domain_name": "General Security Concepts", "question": "What is SSO?", "options": [{"id": "a", "text": "Security system operation"}, {"id": "b", "text": "Single Sign-On"}, {"id": "c", "text": "Secure server only"}, {"id": "d", "text": "System security option"}], "correct_answer": "b", "explanation": "SSO allows users to authenticate once and access multiple applications without re-entering credentials, improving user experience and security."},
    {"domain": 1, "domain_name": "General Security Concepts", "question": "What is LDAP?", "options": [{"id": "a", "text": "Light data protocol"}, {"id": "b", "text": "Lightweight Directory Access Protocol"}, {"id": "c", "text": "Local directory"}, {"id": "d", "text": "Link data access"}], "correct_answer": "b", "explanation": "LDAP is a protocol for accessing and maintaining distributed directory information services, commonly used for authentication and user management."},
    {"domain": 1, "domain_name": "General Security Concepts", "question": "What is FIDO2?", "options": [{"id": "a", "text": "Dog tracker"}, {"id": "b", "text": "Passwordless authentication standard"}, {"id": "c", "text": "File identifier"}, {"id": "d", "text": "Financial data"}], "correct_answer": "b", "explanation": "FIDO2 is an authentication standard enabling passwordless login using biometrics or security keys, resisting phishing and credential theft."},
    {"domain": 1, "domain_name": "General Security Concepts", "question": "What is a security key?", "options": [{"id": "a", "text": "Physical key"}, {"id": "b", "text": "Hardware device for authentication"}, {"id": "c", "text": "Encryption key"}, {"id": "d", "text": "Key card"}], "correct_answer": "b", "explanation": "A security key is a hardware device (like YubiKey) used for strong authentication, typically supporting FIDO2, U2F, or other protocols."},
    {"domain": 1, "domain_name": "General Security Concepts", "question": "What is PAM in identity management?", "options": [{"id": "a", "text": "Pluggable authentication"}, {"id": "b", "text": "Privileged Access Management"}, {"id": "c", "text": "Password access module"}, {"id": "d", "text": "Protocol access manager"}], "correct_answer": "b", "explanation": "PAM manages and monitors privileged accounts, providing secure access to critical systems and auditing privileged activities."},
    {"domain": 1, "domain_name": "General Security Concepts", "question": "What is just-in-time (JIT) access?", "options": [{"id": "a", "text": "Fast access"}, {"id": "b", "text": "Temporary elevated privileges when needed"}, {"id": "c", "text": "Manufacturing term"}, {"id": "d", "text": "Quick login"}], "correct_answer": "b", "explanation": "JIT access grants elevated privileges only when needed and for limited time, reducing the attack surface of privileged accounts."},
    
    # More Domain 2 - Malware & Attacks
    {"domain": 2, "domain_name": "Threats, Vulnerabilities & Mitigations", "question": "What is a dropper?", "options": [{"id": "a", "text": "Clumsy person"}, {"id": "b", "text": "Malware that installs other malware"}, {"id": "c", "text": "Download manager"}, {"id": "d", "text": "Drug delivery"}], "correct_answer": "b", "explanation": "A dropper is malware designed to install other malicious software on the victim's system, often disguised as legitimate software."},
    {"domain": 2, "domain_name": "Threats, Vulnerabilities & Mitigations", "question": "What is a downloader?", "options": [{"id": "a", "text": "Download manager"}, {"id": "b", "text": "Malware that downloads additional payloads"}, {"id": "c", "text": "File transfer"}, {"id": "d", "text": "Browser extension"}], "correct_answer": "b", "explanation": "A downloader is malware that downloads additional malicious components from the internet after initial infection."},
    {"domain": 2, "domain_name": "Threats, Vulnerabilities & Mitigations", "question": "What is a backdoor?", "options": [{"id": "a", "text": "Rear entrance"}, {"id": "b", "text": "Hidden access method bypassing normal authentication"}, {"id": "c", "text": "Exit strategy"}, {"id": "d", "text": "Secondary login"}], "correct_answer": "b", "explanation": "A backdoor provides hidden access to a system, bypassing normal authentication. It can be malicious or intentionally created by developers."},
    {"domain": 2, "domain_name": "Threats, Vulnerabilities & Mitigations", "question": "What is a RAT?", "options": [{"id": "a", "text": "Rodent"}, {"id": "b", "text": "Remote Access Trojan"}, {"id": "c", "text": "Remote admin tool"}, {"id": "d", "text": "Resource allocation"}], "correct_answer": "b", "explanation": "A RAT (Remote Access Trojan) gives attackers remote control over infected systems, enabling surveillance, data theft, and further attacks."},
    {"domain": 2, "domain_name": "Threats, Vulnerabilities & Mitigations", "question": "What is adware?", "options": [{"id": "a", "text": "Advertisement software"}, {"id": "b", "text": "Software displaying unwanted advertisements"}, {"id": "c", "text": "Ad creation"}, {"id": "d", "text": "Advanced software"}], "correct_answer": "b", "explanation": "Adware displays unwanted advertisements, often bundled with free software. While not always malicious, it can degrade performance and privacy."},
    {"domain": 2, "domain_name": "Threats, Vulnerabilities & Mitigations", "question": "What is spyware?", "options": [{"id": "a", "text": "Spy tools"}, {"id": "b", "text": "Software that secretly monitors user activity"}, {"id": "c", "text": "Spy movie"}, {"id": "d", "text": "Security software"}], "correct_answer": "b", "explanation": "Spyware secretly monitors user activity, collecting information like keystrokes, browsing history, and credentials without consent."},
    {"domain": 2, "domain_name": "Threats, Vulnerabilities & Mitigations", "question": "What is a POS malware?", "options": [{"id": "a", "text": "Positive malware"}, {"id": "b", "text": "Point-of-Sale malware targeting payment systems"}, {"id": "c", "text": "Power of suggestion"}, {"id": "d", "text": "Position malware"}], "correct_answer": "b", "explanation": "POS malware targets point-of-sale systems to steal payment card data from memory during transaction processing."},
    {"domain": 2, "domain_name": "Threats, Vulnerabilities & Mitigations", "question": "What is memory scraping?", "options": [{"id": "a", "text": "Cleaning memory"}, {"id": "b", "text": "Extracting sensitive data from RAM"}, {"id": "c", "text": "Memory cleaning"}, {"id": "d", "text": "Scrapbook"}], "correct_answer": "b", "explanation": "Memory scraping malware reads sensitive data (like payment cards) from RAM before it's encrypted, commonly used in POS attacks."},
    {"domain": 2, "domain_name": "Threats, Vulnerabilities & Mitigations", "question": "What is a supply chain compromise?", "options": [{"id": "a", "text": "Shipping attack"}, {"id": "b", "text": "Attacking through trusted vendors or software"}, {"id": "c", "text": "Chain store attack"}, {"id": "d", "text": "Supplier bankruptcy"}], "correct_answer": "b", "explanation": "Supply chain compromise infiltrates organizations through trusted vendors, software updates, or hardware, as seen in the SolarWinds attack."},
    {"domain": 2, "domain_name": "Threats, Vulnerabilities & Mitigations", "question": "What is island hopping attack?", "options": [{"id": "a", "text": "Vacation attack"}, {"id": "b", "text": "Attacking through connected partners/suppliers"}, {"id": "c", "text": "Geographic attack"}, {"id": "d", "text": "Network hopping"}], "correct_answer": "b", "explanation": "Island hopping attacks compromise a smaller, connected organization to access the primary target through trusted relationships."},
    
    # More Domain 3 - Cloud & Virtual Security
    {"domain": 3, "domain_name": "Security Architecture", "question": "What is a Type 1 hypervisor?", "options": [{"id": "a", "text": "First version"}, {"id": "b", "text": "Bare-metal hypervisor running directly on hardware"}, {"id": "c", "text": "Basic hypervisor"}, {"id": "d", "text": "Test hypervisor"}], "correct_answer": "b", "explanation": "Type 1 (bare-metal) hypervisors run directly on hardware without a host OS. Examples include VMware ESXi and Microsoft Hyper-V Server."},
    {"domain": 3, "domain_name": "Security Architecture", "question": "What is a Type 2 hypervisor?", "options": [{"id": "a", "text": "Second version"}, {"id": "b", "text": "Hypervisor running on a host operating system"}, {"id": "c", "text": "Advanced hypervisor"}, {"id": "d", "text": "Backup hypervisor"}], "correct_answer": "b", "explanation": "Type 2 hypervisors run on a host OS. Examples include VMware Workstation and VirtualBox. They're less performant but easier to set up."},
    {"domain": 3, "domain_name": "Security Architecture", "question": "What is VM escape?", "options": [{"id": "a", "text": "VM removal"}, {"id": "b", "text": "Breaking out of VM to access host or other VMs"}, {"id": "c", "text": "VM migration"}, {"id": "d", "text": "VM export"}], "correct_answer": "b", "explanation": "VM escape is an attack where malicious code breaks out of a virtual machine to access the host system or other VMs, bypassing isolation."},
    {"domain": 3, "domain_name": "Security Architecture", "question": "What is VM sprawl?", "options": [{"id": "a", "text": "VM growth"}, {"id": "b", "text": "Uncontrolled proliferation of virtual machines"}, {"id": "c", "text": "VM spread"}, {"id": "d", "text": "Large VMs"}], "correct_answer": "b", "explanation": "VM sprawl is uncontrolled creation of VMs that become difficult to manage, potentially creating security gaps and resource waste."},
    {"domain": 3, "domain_name": "Security Architecture", "question": "What is cloud access security broker (CASB)?", "options": [{"id": "a", "text": "Cloud sales"}, {"id": "b", "text": "Security policy enforcement between users and cloud"}, {"id": "c", "text": "Cloud backup"}, {"id": "d", "text": "Access management"}], "correct_answer": "b", "explanation": "A CASB enforces security policies between users and cloud services, providing visibility, data security, and threat protection."},
    {"domain": 3, "domain_name": "Security Architecture", "question": "What is serverless computing security?", "options": [{"id": "a", "text": "No security needed"}, {"id": "b", "text": "Security for function-as-a-service platforms"}, {"id": "c", "text": "Server removal"}, {"id": "d", "text": "Less secure computing"}], "correct_answer": "b", "explanation": "Serverless security focuses on function code security, permissions, dependencies, and data protection in FaaS environments like AWS Lambda."},
    {"domain": 3, "domain_name": "Security Architecture", "question": "What is container orchestration security?", "options": [{"id": "a", "text": "Music containers"}, {"id": "b", "text": "Security for platforms managing container deployment"}, {"id": "c", "text": "Container shipping"}, {"id": "d", "text": "Container arrangement"}], "correct_answer": "b", "explanation": "Container orchestration security covers Kubernetes and similar platforms, including pod security, network policies, and secrets management."},
    {"domain": 3, "domain_name": "Security Architecture", "question": "What is a Kubernetes pod?", "options": [{"id": "a", "text": "Whale group"}, {"id": "b", "text": "Smallest deployable unit containing one or more containers"}, {"id": "c", "text": "Kubernetes version"}, {"id": "d", "text": "Container type"}], "correct_answer": "b", "explanation": "A pod is the smallest deployable unit in Kubernetes, containing one or more containers that share storage and network resources."},
    {"domain": 3, "domain_name": "Security Architecture", "question": "What is a network policy in Kubernetes?", "options": [{"id": "a", "text": "HR policy"}, {"id": "b", "text": "Rules controlling pod network traffic"}, {"id": "c", "text": "ISP policy"}, {"id": "d", "text": "Firewall rules"}], "correct_answer": "b", "explanation": "Kubernetes network policies are rules controlling which pods can communicate with each other and external services, implementing microsegmentation."},
    {"domain": 3, "domain_name": "Security Architecture", "question": "What is image signing in containers?", "options": [{"id": "a", "text": "Picture signing"}, {"id": "b", "text": "Cryptographically verifying container image integrity"}, {"id": "c", "text": "Image watermarking"}, {"id": "d", "text": "Autograph"}], "correct_answer": "b", "explanation": "Container image signing cryptographically verifies that images haven't been tampered with and come from trusted sources."},
    
    # More Domain 4 - Incident Response
    {"domain": 4, "domain_name": "Security Operations", "question": "What is the containment phase?", "options": [{"id": "a", "text": "Container security"}, {"id": "b", "text": "Preventing incident spread while preserving evidence"}, {"id": "c", "text": "Packaging"}, {"id": "d", "text": "Storage"}], "correct_answer": "b", "explanation": "Containment stops the spread of an incident while preserving evidence. It may involve short-term (immediate) and long-term actions."},
    {"domain": 4, "domain_name": "Security Operations", "question": "What is eradication in incident response?", "options": [{"id": "a", "text": "Disease control"}, {"id": "b", "text": "Removing threat artifacts and vulnerabilities"}, {"id": "c", "text": "Deletion"}, {"id": "d", "text": "Cleaning"}], "correct_answer": "b", "explanation": "Eradication removes malware, compromised accounts, and vulnerabilities that allowed the attack, ensuring the threat is fully eliminated."},
    {"domain": 4, "domain_name": "Security Operations", "question": "What is recovery phase?", "options": [{"id": "a", "text": "Data recovery"}, {"id": "b", "text": "Restoring systems to normal operations"}, {"id": "c", "text": "Financial recovery"}, {"id": "d", "text": "Health recovery"}], "correct_answer": "b", "explanation": "Recovery restores affected systems to normal operations, including rebuilding systems, restoring data, and returning to production."},
    {"domain": 4, "domain_name": "Security Operations", "question": "What is lessons learned phase?", "options": [{"id": "a", "text": "Training"}, {"id": "b", "text": "Post-incident review to improve future response"}, {"id": "c", "text": "Education"}, {"id": "d", "text": "Documentation"}], "correct_answer": "b", "explanation": "Lessons learned (post-incident activity) reviews what happened, what worked, what didn't, and how to improve future response."},
    {"domain": 4, "domain_name": "Security Operations", "question": "What is chain of custody?", "options": [{"id": "a", "text": "Prison chain"}, {"id": "b", "text": "Documentation of who handled evidence"}, {"id": "c", "text": "Child custody"}, {"id": "d", "text": "Key chain"}], "correct_answer": "b", "explanation": "Chain of custody documents everyone who handled evidence, when, and what was done, ensuring evidence integrity for legal proceedings."},
    {"domain": 4, "domain_name": "Security Operations", "question": "What is evidence preservation?", "options": [{"id": "a", "text": "Food preservation"}, {"id": "b", "text": "Protecting evidence from modification or destruction"}, {"id": "c", "text": "Document storage"}, {"id": "d", "text": "File backup"}], "correct_answer": "b", "explanation": "Evidence preservation protects digital evidence from modification, using methods like hashing, write blockers, and forensic imaging."},
    {"domain": 4, "domain_name": "Security Operations", "question": "What is timeline analysis?", "options": [{"id": "a", "text": "Schedule planning"}, {"id": "b", "text": "Reconstructing sequence of events during investigation"}, {"id": "c", "text": "Project timeline"}, {"id": "d", "text": "History lesson"}], "correct_answer": "b", "explanation": "Timeline analysis reconstructs the sequence of events during an incident using timestamps from logs, files, and other artifacts."},
    {"domain": 4, "domain_name": "Security Operations", "question": "What is root cause analysis?", "options": [{"id": "a", "text": "Plant analysis"}, {"id": "b", "text": "Identifying the underlying cause of an incident"}, {"id": "c", "text": "Root vegetable"}, {"id": "d", "text": "Foundation analysis"}], "correct_answer": "b", "explanation": "Root cause analysis identifies the fundamental cause of an incident, enabling effective remediation and prevention of recurrence."},
    {"domain": 4, "domain_name": "Security Operations", "question": "What is mean time to contain (MTTC)?", "options": [{"id": "a", "text": "Average container time"}, {"id": "b", "text": "Average time to stop incident spread"}, {"id": "c", "text": "Container measurement"}, {"id": "d", "text": "Time to capture"}], "correct_answer": "b", "explanation": "MTTC measures the average time from incident detection to containment, indicating how quickly the security team can stop threats."},
    {"domain": 4, "domain_name": "Security Operations", "question": "What is attack surface reduction?", "options": [{"id": "a", "text": "Surface cleaning"}, {"id": "b", "text": "Minimizing potential entry points for attackers"}, {"id": "c", "text": "Area reduction"}, {"id": "d", "text": "Physical reduction"}], "correct_answer": "b", "explanation": "Attack surface reduction minimizes the number of potential entry points by removing unnecessary services, closing ports, and limiting exposure."},
    
    # More Domain 5 - Governance
    {"domain": 5, "domain_name": "Security Program Management", "question": "What is COBIT?", "options": [{"id": "a", "text": "Computer bit"}, {"id": "b", "text": "Control Objectives for Information and Related Technology"}, {"id": "c", "text": "Coding bit"}, {"id": "d", "text": "Company bit"}], "correct_answer": "b", "explanation": "COBIT is a framework for IT governance and management, providing best practices for aligning IT with business goals."},
    {"domain": 5, "domain_name": "Security Program Management", "question": "What is ITIL?", "options": [{"id": "a", "text": "IT island"}, {"id": "b", "text": "Information Technology Infrastructure Library"}, {"id": "c", "text": "Internet tool"}, {"id": "d", "text": "IT installation"}], "correct_answer": "b", "explanation": "ITIL is a framework of best practices for IT service management, covering service strategy, design, transition, operation, and improvement."},
    {"domain": 5, "domain_name": "Security Program Management", "question": "What is SABSA?", "options": [{"id": "a", "text": "Security association"}, {"id": "b", "text": "Sherwood Applied Business Security Architecture"}, {"id": "c", "text": "Security audit"}, {"id": "d", "text": "System architecture"}], "correct_answer": "b", "explanation": "SABSA is a framework for developing risk-driven security architectures, aligning security with business requirements."},
    {"domain": 5, "domain_name": "Security Program Management", "question": "What is TOGAF?", "options": [{"id": "a", "text": "Technology organization"}, {"id": "b", "text": "The Open Group Architecture Framework"}, {"id": "c", "text": "Total governance"}, {"id": "d", "text": "Technical organization"}], "correct_answer": "b", "explanation": "TOGAF is an enterprise architecture framework providing methods and tools for designing, planning, implementing, and governing IT architecture."},
    {"domain": 5, "domain_name": "Security Program Management", "question": "What is a security charter?", "options": [{"id": "a", "text": "Security flight"}, {"id": "b", "text": "Document defining security program authority and scope"}, {"id": "c", "text": "Security rental"}, {"id": "d", "text": "Security agreement"}], "correct_answer": "b", "explanation": "A security charter formally establishes the security program, defining its authority, scope, responsibilities, and relationship to the organization."},
    {"domain": 5, "domain_name": "Security Program Management", "question": "What is security governance?", "options": [{"id": "a", "text": "Government security"}, {"id": "b", "text": "Framework for security decision-making and accountability"}, {"id": "c", "text": "Security rules"}, {"id": "d", "text": "Security laws"}], "correct_answer": "b", "explanation": "Security governance provides the framework for security decision-making, ensuring alignment with business objectives and regulatory requirements."},
    {"domain": 5, "domain_name": "Security Program Management", "question": "What is a security steering committee?", "options": [{"id": "a", "text": "Driving committee"}, {"id": "b", "text": "Senior group providing security program direction"}, {"id": "c", "text": "Navigation team"}, {"id": "d", "text": "Security guards"}], "correct_answer": "b", "explanation": "A security steering committee is a senior management group that provides strategic direction, approves policies, and ensures security alignment with business goals."},
    {"domain": 5, "domain_name": "Security Program Management", "question": "What is security maturity model?", "options": [{"id": "a", "text": "Age of security"}, {"id": "b", "text": "Framework measuring security program development"}, {"id": "c", "text": "Security experience"}, {"id": "d", "text": "Old security"}], "correct_answer": "b", "explanation": "A security maturity model assesses an organization's security capabilities across various levels, from initial/ad-hoc to optimized."},
    {"domain": 5, "domain_name": "Security Program Management", "question": "What is key performance indicator (KPI)?", "options": [{"id": "a", "text": "Key index"}, {"id": "b", "text": "Metric measuring progress toward objectives"}, {"id": "c", "text": "Performance key"}, {"id": "d", "text": "Key indicator"}], "correct_answer": "b", "explanation": "KPIs are measurable values demonstrating how effectively an organization achieves key objectives, used to evaluate security program success."},
    {"domain": 5, "domain_name": "Security Program Management", "question": "What is key risk indicator (KRI)?", "options": [{"id": "a", "text": "Risk key"}, {"id": "b", "text": "Metric signaling potential risk increases"}, {"id": "c", "text": "Key risk"}, {"id": "d", "text": "Risk indicator"}], "correct_answer": "b", "explanation": "KRIs are metrics that signal potential increases in risk levels, enabling proactive risk management before issues materialize."}
]

async def add_questions():
    for q in questions:
        q["id"] = str(uuid.uuid4())
    result = await db.questions.insert_many(questions)
    print(f"Added {len(result.inserted_ids)} questions")
    total = await db.questions.count_documents({})
    print(f"Total: {total}")

if __name__ == "__main__":
    asyncio.run(add_questions())
